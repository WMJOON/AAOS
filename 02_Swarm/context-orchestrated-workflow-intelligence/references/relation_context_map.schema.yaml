$schema: "https://json-schema.org/draft/2020-12/schema"
title: relation_context_map
type: object
required:
  - workflow_id
  - ticket_context_id
  - topology_nodes
  - context_links
  - handoff_rules
  - conversation_context
  - agent_namespace
  - conflict_resolution_rule
properties:
  workflow_id:
    type: string
    minLength: 1
  ticket_context_id:
    type: string
    minLength: 1
  topology_nodes:
    type: array
    items:
      type: object
      required:
        - node_id
      properties:
        node_id:
          type: string
        role:
          type: string
        purpose:
          type: string
      additionalProperties: true
  context_links:
    type: array
    items:
      type: object
      required:
        - from
        - to
        - relation
      properties:
        from:
          type: string
        to:
          type: string
        relation:
          type: string
        note:
          type: string
      additionalProperties: true
  handoff_rules:
    type: array
    items:
      type: object
      required:
        - source
        - destination
        - condition
      properties:
        source:
          type: string
        destination:
          type: string
        condition:
          type: string
        payload_contract:
          type: string
      additionalProperties: true
  conversation_context:
    type: object
    required:
      - source
      - session_id
      - captured_at
      - snapshot_path
      - decision_refs
    properties:
      source:
        type: string
      session_id:
        type: string
      captured_at:
        type: string
      snapshot_path:
        type: string
      decision_refs:
        type: array
        items:
          type: string
    additionalProperties: true
  agent_namespace:
    type: object
    required:
      - agent_family
      - agent_version
      - namespace_path
    properties:
      agent_family:
        type: string
      agent_version:
        type: string
      namespace_path:
        type: string
    additionalProperties: true
  conflict_resolution_rule:
    type: object
    required:
      - strategy
    properties:
      strategy:
        type: string
      escalation_path:
        type: string
      owner:
        type: string
    additionalProperties: true
additionalProperties: false
